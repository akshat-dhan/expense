<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- 📱 PWA MANIFEST -->
    <link rel="manifest" href="/manifest.json">

    <!-- 🍎 iOS SPECIFIC -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Backpack Optimizer">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <link rel="apple-touch-startup-image" href="/icons/icon-512.png">

    <!-- 🤖 ANDROID/CHROME -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#007AFF">

    <!-- 🪟 WINDOWS -->
    <meta name="msapplication-TileColor" content="#007AFF">
    <meta name="msapplication-TileImage" content="/icons/icon-192.png">

    <!-- 🔍 SEO & SOCIAL -->
    <meta name="application-name" content="Backpack Optimizer">
    <meta name="description" content="AI-powered financial management for Indian students">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backpack Optimizer - Elite Campus Housing</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="housing.css">
</head>
<body>
    <!-- 📱 FIXED MOBILE MENU TOGGLE BUTTON -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </button>

    <!-- 📱 MOBILE OVERLAY -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Enhanced Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">🎒 Backpack Optimizer</div>
            <div class="tagline">Elite Campus Housing</div>
        </div>
        
        <div class="user-profile">
            <div class="user-avatar" id="userAvatar">A</div>
            <div id="userName" style="font-size: 20px; font-weight: 800;">Loading...</div>
            <div id="userCampus" style="font-size: 14px; opacity: 0.9;">Loading...</div>
            <div style="font-size: 12px; margin-top: 8px; opacity: 0.8;" id="userRegNumber">Loading...</div>
            <div style="font-size: 13px; margin-top: 12px; background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 12px;">🏠 Housing Pro</div>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="dashboard.html" class="nav-link">
                    <span class="nav-icon">📊</span>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="expenses.html" class="nav-link">
                    <span class="nav-icon">💸</span>
                    <span>My Expenses</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="add-expense.html" class="nav-link">
                    <span class="nav-icon">➕</span>
                    <span>Add Expense</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="wishboard.html" class="nav-link">
                    <span class="nav-icon">⭐</span>
                    <span>Wishboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="marketplace.html" class="nav-link">
                    <span class="nav-icon">🛒</span>
                    <span>Marketplace</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="housing.html" class="nav-link active">
                    <span class="nav-icon">🏠</span>
                    <span>Housing</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="analytics.html" class="nav-link">
                    <span class="nav-icon">📈</span>
                    <span>Analytics</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="profile.html" class="nav-link">
                    <span class="nav-icon">👤</span>
                    <span>Profile</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" onclick="logout()">
                    <span class="nav-icon">🚪</span>
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- Enhanced Main Content -->
    <div class="main-content">
        <div class="page-header">
            <h1 class="page-title">🏠 Elite Campus Housing</h1>
            <p class="page-subtitle">Find your perfect home away from home with smart recommendations</p>
            <div class="campus-badge" id="campusBadge">🏛️ Christ University Exclusive</div>
        </div>

        <!-- **NEW: Enhanced Statistics Overview** -->
        <div class="stats-overview">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                <span class="stat-icon">🏠</span>
                <div class="stat-value" id="totalListings">0</div>
                <div class="stat-label">Available Homes</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                <span class="stat-icon">💰</span>
                <div class="stat-value" id="avgRent">₹0</div>
                <div class="stat-label">Average Rent</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                <span class="stat-icon">🏘️</span>
                <div class="stat-value" id="totalAreas">0</div>
                <div class="stat-label">Different Areas</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                <span class="stat-icon">👥</span>
                <div class="stat-value" id="totalHosts">0</div>
                <div class="stat-label">Verified Hosts</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #FFD700, #FFA500);">
                <span class="stat-icon">🎓</span>
                <div class="stat-value" id="campusOnly">100%</div>
                <div class="stat-label">Student Safe</div>
            </div>
        </div>

        <!-- Enhanced List Property Form -->
        <div class="card">
            <h3 style="margin-bottom: 25px; font-size: 24px; font-weight: 900;">🏡 List Your Property</h3>
            <form id="housingForm" onsubmit="listHousing(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="housingTitle">🏠 Property Title</label>
                        <input type="text" class="form-control" id="housingTitle" placeholder="e.g., Luxury 2BHK Near Christ University with Modern Amenities" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="housingRent">💰 Monthly Rent (₹)</label>
                        <input type="number" class="form-control" id="housingRent" placeholder="0.00" step="100" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="housingLocation">📍 Detailed Location</label>
                        <input type="text" class="form-control" id="housingLocation" placeholder="e.g., Hosur Road, Electronic City Phase 1, Near Christ University Main Gate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="housingType">🏠 Property Type</label>
                        <select class="form-control" id="housingType" required>
                            <option value="apartment">🏢 Apartment/Flat</option>
                            <option value="pg">🏠 PG/Paying Guest</option>
                            <option value="room">🚪 Single Room</option>
                            <option value="villa">🏡 Villa/Independent House</option>
                            <option value="shared">👥 Shared Room</option>
                            <option value="studio">🎨 Studio Apartment</option>
                        </select>
                    </div>
                </div>
                <div class="form-row-3">
                    <div class="form-group">
                        <label class="form-label" for="housingBedrooms">🛏️ Bedrooms</label>
                        <select class="form-control" id="housingBedrooms" required>
                            <option value="1">1 Bedroom</option>
                            <option value="2">2 Bedrooms</option>
                            <option value="3">3 Bedrooms</option>
                            <option value="4">4+ Bedrooms</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="housingBathrooms">🚿 Bathrooms</label>
                        <select class="form-control" id="housingBathrooms" required>
                            <option value="1">1 Bathroom</option>
                            <option value="2">2 Bathrooms</option>
                            <option value="3">3+ Bathrooms</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="housingFurnished">🛋️ Furnishing Status</label>
                        <select class="form-control" id="housingFurnished" required>
                            <option value="fully">✅ Fully Furnished</option>
                            <option value="semi">🔧 Semi Furnished</option>
                            <option value="unfurnished">❌ Unfurnished</option>
                        </select>
                    </div>
                </div>

                <!-- **NEW: Professional Image Upload Section** -->
                <div class="form-group">
                    <label class="form-label">📸 Property Images</label>
                    <div class="image-upload-section" id="imageUploadSection" onclick="document.getElementById('imageUpload').click()">
                        <span class="upload-icon">🏠</span>
                        <div class="upload-text">Click to Add Property Images</div>
                        <div class="upload-subtext">Add up to 8 high-quality photos showcasing your property</div>
                        <input type="file" id="imageUpload" multiple accept="image/*" onchange="handleImageUpload(event)">
                        <div class="image-preview-container" id="imagePreviewContainer"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">⭐ Premium Amenities (Select all available)</label>
                    <div class="amenities-checkboxes">
                        <label class="checkbox-item">
                            <input type="checkbox" id="wifi" value="High-Speed WiFi">
                            <span>📶 High-Speed WiFi</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="ac" value="Air Conditioning">
                            <span>❄️ Air Conditioning</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="parking" value="Parking">
                            <span>🚗 Dedicated Parking</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="laundry" value="Laundry">
                            <span>👕 Laundry Service</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="gym" value="Gym">
                            <span>💪 Fitness Center</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="security" value="24/7 Security">
                            <span>🛡️ 24/7 Security</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="kitchen" value="Modular Kitchen">
                            <span>🍳 Modular Kitchen</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="balcony" value="Balcony">
                            <span>🌅 Balcony/Terrace</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="elevator" value="Elevator">
                            <span>🛗 Elevator Access</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="powerbackup" value="Power Backup">
                            <span>⚡ Power Backup</span>
                        </label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="housingContact">📞 Contact Information</label>
                        <input type="text" class="form-control" id="housingContact" placeholder="WhatsApp: +91-9876543210 | Email: contact@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="housingDeposit">💎 Security Deposit (₹)</label>
                        <input type="number" class="form-control" id="housingDeposit" placeholder="0.00" step="100">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="housingDescription">📝 Comprehensive Description</label>
                    <textarea class="form-control" id="housingDescription" rows="6" placeholder="Provide detailed information about your property:
• Room specifications and layout
• Nearby facilities (markets, hospitals, transport)
• House rules and preferences
• Included utilities and services
• Distance from college/university
• Special features or unique selling points
• Any restrictions or requirements for tenants..." required></textarea>
                </div>
                <button type="submit" class="btn btn-success" style="padding: 20px 40px; font-size: 18px;">
                    🏡 List Property on Platform
                </button>
            </form>
        </div>

        <!-- Enhanced Browse Housing -->
        <div class="card">
            <h3 style="margin-bottom: 25px; font-size: 24px; font-weight: 900;">🔍 Find Your Perfect Home</h3>
            <div class="form-row-3">
                <div class="form-group">
                    <label class="form-label" for="housingSearch">🔍 Search Properties</label>
                    <input type="text" class="form-control" id="housingSearch" placeholder="Search by location, type, or amenities..." onkeyup="filterHousing()">
                </div>
                <div class="form-group">
                    <label class="form-label" for="housingTypeFilter">🏠 Property Type</label>
                    <select class="form-control" id="housingTypeFilter" onchange="filterHousing()">
                        <option value="all">All Property Types</option>
                        <option value="apartment">🏢 Apartment/Flat</option>
                        <option value="pg">🏠 PG/Paying Guest</option>
                        <option value="room">🚪 Single Room</option>
                        <option value="villa">🏡 Villa/House</option>
                        <option value="shared">👥 Shared Room</option>
                        <option value="studio">🎨 Studio Apartment</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="rentSort">💰 Sort Properties</label>
                    <select class="form-control" id="rentSort" onchange="filterHousing()">
                        <option value="newest">🆕 Newest Listings</option>
                        <option value="rent-low">💰 Rent: Low to High</option>
                        <option value="rent-high">💎 Rent: High to Low</option>
                        <option value="popular">⭐ Most Popular</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Enhanced Housing Listings Display -->
        <div class="card">
            <h3 style="margin-bottom: 25px; font-size: 24px; font-weight: 900;">🏠 Available Properties (<span id="listingCount">0</span>)</h3>
            <div class="housing-grid" id="housingGrid">
                <!-- Housing items will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="housing.js"></script>
</body>
</html>
