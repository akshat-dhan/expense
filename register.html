<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- 📱 PWA MANIFEST -->
<link rel="manifest" href="/manifest.json">

<!-- 🍎 iOS SPECIFIC -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Backpack Optimizer">
<link rel="apple-touch-icon" href="/icons/icon-192.png">
<link rel="apple-touch-startup-image" href="/icons/icon-512.png">

<!-- 🤖 ANDROID/CHROME -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#007AFF">

<!-- 🪟 WINDOWS -->
<meta name="msapplication-TileColor" content="#007AFF">
<meta name="msapplication-TileImage" content="/icons/icon-192.png">

<!-- 🔍 SEO & SOCIAL -->
<meta name="application-name" content="Backpack Optimizer">
<meta name="description" content="AI-powered financial management for Indian students">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backpack Optimizer - Create Your Smart Student Account</title>
    <style>
        :root {
            --primary-blue: #007AFF;
            --primary-purple: #5856D6;
            --success-green: #34C759;
            --danger-red: #FF3B30;
            --warning-orange: #FF9500;
            --info-cyan: #5AC8FA;
            --system-gray: #8E8E93;
            --system-gray4: #D1D1D6;
            --system-gray5: #E5E5EA;
            --system-gray6: #F2F2F7;
            --surface: #FFFFFF;
            --text-primary: #1C1C1E;
            --text-secondary: #3A3A3C;
            --border-radius: 16px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, var(--primary-blue), var(--primary-purple));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        /* Enhanced Navigation Header */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 0;
            z-index: 1000;
            border-bottom: 1px solid var(--system-gray5);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            font-size: 24px;
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }

        .nav-link {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 12px;
            transition: var(--transition);
        }

        .nav-link:hover {
            background: rgba(0, 122, 255, 0.1);
        }

        .auth-container {
            max-width: 800px;
            margin: 100px auto 50px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            padding: 50px;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.3);
            text-align: center;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 24px 24px 0 0;
        }

        .auth-title {
            font-size: 2.8rem;
            font-weight: 900;
            margin-bottom: 16px;
            color: var(--text-primary);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .auth-subtitle {
            font-size: 1.2rem;
            color: var(--system-gray);
            margin-bottom: 40px;
            font-style: italic;
        }

        /* Enhanced Profile Picture Section */
        .profile-picture-section {
            margin-bottom: 35px;
            padding: 25px;
            border: 2px dashed var(--system-gray4);
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(0, 122, 255, 0.05), rgba(88, 86, 214, 0.05));
            text-align: center;
            transition: var(--transition);
        }

        .profile-picture-section:hover {
            border-color: var(--primary-blue);
            background: linear-gradient(135deg, rgba(0, 122, 255, 0.1), rgba(88, 86, 214, 0.1));
        }

        .image-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .image-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .image-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.3);
        }

        .image-preview {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-blue);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            margin: 20px auto;
            display: none;
            transition: var(--transition);
        }

        .image-preview:hover {
            transform: scale(1.05);
        }

        .file-input {
            display: none;
        }

        /* Enhanced Form Sections */
        .form-section {
            background: var(--system-gray6);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 4px solid var(--primary-blue);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary-blue);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 24px;
            text-align: left;
        }

        .form-label {
            display: block;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .form-control {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid var(--system-gray4);
            border-radius: var(--border-radius);
            font-size: 16px;
            background: var(--surface);
            transition: var(--transition);
            font-family: inherit;
            font-weight: 500;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
            transform: translateY(-2px);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        /* Enhanced Button */
        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: var(--border-radius);
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            width: 100%;
            margin: 30px 0;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0, 122, 255, 0.4);
        }

        /* Campus-Specific Info */
        .campus-info {
            background: linear-gradient(135deg, #E8F5FF, #F0F9FF);
            border: 2px solid var(--info-cyan);
            border-radius: 16px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
        }

        .campus-benefits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .campus-benefit {
            background: white;
            padding: 15px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        .campus-benefit:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .flash-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--surface);
            border-radius: var(--border-radius);
            padding: 20px 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            border-left: 5px solid var(--success-green);
            z-index: 2000;
            font-weight: 600;
            max-width: 400px;
            animation: slideIn 0.3s ease;
        }

        .flash-error {
            border-left-color: var(--danger-red);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Professional Footer */
        .register-footer {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            padding: 30px 0 20px;
            margin-top: 60px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            text-align: center;
        }

        .developer-credit {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .auth-container {
                margin: 80px 15px 30px;
                padding: 30px 25px;
            }

            .form-row, .form-row-3 {
                grid-template-columns: 1fr;
            }

            .image-options {
                flex-direction: column;
                align-items: center;
            }

            .campus-benefits {
                grid-template-columns: 1fr;
            }

            .nav-container {
                padding: 0 15px;
            }

            .auth-title {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Enhanced Navigation -->
    <nav class="top-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">🎒 Backpack Optimizer</a>
            <a href="index.html" class="nav-link">← Back to Login</a>
        </div>
    </nav>

    <div class="auth-container">
        <h1 class="auth-title">Join the Revolution! 🎉</h1>
        <p class="auth-subtitle">"Every financial goal starts with a single step" - Create your smart student account</p>
        
        <form id="registerForm" onsubmit="handleRegister(event)">
            <!-- Enhanced Profile Picture Section -->
            <div class="profile-picture-section">
                <h4 style="margin-bottom: 15px; color: var(--primary-blue); font-weight: 800;">📸 Profile Picture (Optional)</h4>
                
                <div class="image-options">
                    <button type="button" class="image-btn" onclick="chooseFromFiles()">
                        📁 Choose from Files
                    </button>
                    <button type="button" class="image-btn" onclick="captureFromCamera()">
                        📷 Use Camera
                    </button>
                </div>
                
                <input type="file" id="fileInput" class="file-input" accept="image/*" onchange="previewImage(event)">
                <input type="file" id="cameraInput" class="file-input" accept="image/*" capture="environment" onchange="previewImage(event)">
                
                <img id="imagePreview" class="image-preview" alt="Profile Preview">
                
                <p style="font-size: 14px; color: var(--system-gray); margin-top: 15px;">
                    Upload a profile picture to personalize your account and make connections on campus
                </p>
            </div>

            <!-- Basic Information Section -->
            <div class="form-section">
                <h3 class="section-title">👤 Basic Information</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="fullName">📝 Full Name</label>
                        <input type="text" class="form-control" id="fullName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="username">🎯 Username</label>
                        <input type="text" class="form-control" id="username" placeholder="Choose a unique username" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="email">📧 Email Address</label>
                        <input type="email" class="form-control" id="email" placeholder="your.name@university.edu" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="phone">📱 Phone Number</label>
                        <input type="tel" class="form-control" id="phone" placeholder="+91 98765 43210" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="password">🔒 Password</label>
                        <input type="password" class="form-control" id="password" placeholder="Strong password (min 8 chars)" required minlength="8">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="confirmPassword">🔐 Confirm Password</label>
                        <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm your password" required>
                    </div>
                </div>
            </div>

            <!-- Academic Information Section -->
            <div class="form-section">
                <h3 class="section-title">🎓 Academic Information</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="campus">🏫 University/Campus</label>
                        <select class="form-control" id="campus" required onchange="updateCampusInfo()">
                            <option value="">Select Your Campus</option>
                            <option value="CHRIST_BLR">🌟 Christ University Bangalore</option>
                            <option value="DU_DELHI">🎯 Delhi University</option>
                            <option value="VIT_VEL">⚡ VIT Vellore</option>
                            <option value="BITS_PIL">💎 BITS Pilani</option>
                            <option value="IIT_BOM">🚀 IIT Bombay</option>
                            <option value="IIT_DEL">🔬 IIT Delhi</option>
                            <option value="MANIPAL">🌊 Manipal University</option>
                            <option value="SRMU_LKO">📚 Sharda University</option>
                            <option value="AMITY_NOI">🎨 Amity University</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="course">📖 Course/Program</label>
                        <select class="form-control" id="course" required>
                            <option value="">Select Your Course</option>
                            <option value="BCA">💻 BCA (Bachelor of Computer Applications)</option>
                            <option value="B.TECH">⚙️ B.Tech (Bachelor of Technology)</option>
                            <option value="BBA">💼 BBA (Bachelor of Business Administration)</option>
                            <option value="B.COM">💰 B.Com (Bachelor of Commerce)</option>
                            <option value="BA">📚 BA (Bachelor of Arts)</option>
                            <option value="BSC">🔬 B.Sc (Bachelor of Science)</option>
                            <option value="MBA">🎯 MBA (Master of Business Administration)</option>
                            <option value="MCA">💻 MCA (Master of Computer Applications)</option>
                            <option value="M.TECH">⚙️ M.Tech (Master of Technology)</option>
                            <option value="OTHER">🔄 Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row-3">
                    <div class="form-group">
                        <label class="form-label" for="year">📅 Current Year</label>
                        <select class="form-control" id="year" required>
                            <option value="">Select Year</option>
                            <option value="1st Year">1️⃣ 1st Year</option>
                            <option value="2nd Year">2️⃣ 2nd Year</option>
                            <option value="3rd Year">3️⃣ 3rd Year</option>
                            <option value="4th Year">4️⃣ 4th Year</option>
                            <option value="5th Year">5️⃣ 5th Year</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="semester">📝 Current Semester</label>
                        <select class="form-control" id="semester" required>
                            <option value="">Select Semester</option>
                            <option value="1st Sem">1st Semester</option>
                            <option value="2nd Sem">2nd Semester</option>
                            <option value="3rd Sem">3rd Semester</option>
                            <option value="4th Sem">4th Semester</option>
                            <option value="5th Sem">5th Semester</option>
                            <option value="6th Sem">6th Semester</option>
                            <option value="7th Sem">7th Semester</option>
                            <option value="8th Sem">8th Semester</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="rollNumber">🎫 Roll/Registration Number</label>
                        <input type="text" class="form-control" id="rollNumber" placeholder="e.g., 202, 2343105" required>
                    </div>
                </div>
            </div>

            <!-- Location & Personal Information Section -->
            <div class="form-section">
                <h3 class="section-title">📍 Location & Personal Details</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="city">🏙️ City</label>
                        <input type="text" class="form-control" id="city" placeholder="Enter your city" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="state">🗺️ State</label>
                        <select class="form-control" id="state" required>
                            <option value="">Select State</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="West Bengal">West Bengal</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="Andhra Pradesh">Andhra Pradesh</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="accommodation">🏠 Accommodation Type</label>
                        <select class="form-control" id="accommodation" required>
                            <option value="">Select Accommodation</option>
                            <option value="Hostel">🏫 College Hostel</option>
                            <option value="PG">🏡 PG/Paying Guest</option>
                            <option value="Flat">🏢 Shared Flat/Apartment</option>
                            <option value="Home">🏠 Family Home</option>
                            <option value="Other">🔄 Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="familyIncome">💰 Family Income Range (Annual)</label>
                        <select class="form-control" id="familyIncome">
                            <option value="">Select Range (Optional)</option>
                            <option value="Below 3L">Below ₹3 Lakhs</option>
                            <option value="3L-6L">₹3-6 Lakhs</option>
                            <option value="6L-10L">₹6-10 Lakhs</option>
                            <option value="10L-15L">₹10-15 Lakhs</option>
                            <option value="15L-25L">₹15-25 Lakhs</option>
                            <option value="Above 25L">Above ₹25 Lakhs</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Financial Information Section -->
            <div class="form-section">
                <h3 class="section-title">💳 Financial Planning</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="budget">💰 Monthly Budget (₹)</label>
                        <input type="number" class="form-control" id="budget" placeholder="e.g., 15000" min="1000" step="100" required>
                        <small style="color: var(--system-gray); font-size: 14px; display: block; margin-top: 8px;">
                            💡 This helps our AI provide personalized budget recommendations
                        </small>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="savingsGoal">🎯 Monthly Savings Goal (₹)</label>
                        <input type="number" class="form-control" id="savingsGoal" placeholder="e.g., 3000" min="0" step="100">
                        <small style="color: var(--system-gray); font-size: 14px; display: block; margin-top: 8px;">
                            🌟 Set a realistic savings target for better financial discipline
                        </small>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="careerGoals">🚀 Career Goals (Optional)</label>
                    <textarea class="form-control" id="careerGoals" rows="3" placeholder="Tell us about your career aspirations... (helps us suggest relevant financial goals)"></textarea>
                </div>
            </div>

            <!-- Campus-Specific Information -->
            <div class="campus-info" id="campusSpecificInfo" style="display: none;">
                <h4 style="color: var(--info-cyan); font-weight: 800; margin-bottom: 15px;">🏫 Campus-Specific Benefits</h4>
                <div class="campus-benefits" id="campusBenefitsList">
                    <!-- Dynamic content based on selected campus -->
                </div>
            </div>
            
            <button type="submit" class="btn">🎊 Create My Smart Account</button>
        </form>
        
        <p style="color: var(--system-gray); margin-bottom: 16px;">
            Already have an account?
        </p>
        <a href="index.html" style="color: var(--primary-blue); text-decoration: none; font-weight: 600; font-size: 18px;">
            Sign in here 🔐
        </a>
    </div>

    <!-- Professional Footer -->
    <footer class="register-footer">
        <div class="footer-container">
            <p>&copy; 2025 Backpack Optimizer. Made with ❤️ for Indian students.</p>
            <p class="developer-credit">
                Developed by Akshat Maheshwari (2343104) - Christ University BCA | Bangalore, Karnataka
            </p>
        </div>
    </footer>

    <script>
        // ✅ CLEAN REGISTRATION - NO PREDEFINED DATA
        let profileImageBase64 = '';

        function chooseFromFiles() {
            document.getElementById('fileInput').click();
        }

        function captureFromCamera() {
            document.getElementById('cameraInput').click();
        }

        function previewImage(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Enhanced file validation
            if (file.size > 5 * 1024 * 1024) {
                showFlashMessage('📸 Image size must be less than 5MB! Please choose a smaller image.', 'error');
                event.target.value = '';
                return;
            }

            if (!file.type.startsWith('image/')) {
                showFlashMessage('📸 Please select a valid image file (JPG, PNG, etc.)', 'error');
                event.target.value = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                profileImageBase64 = e.target.result;
                
                const preview = document.getElementById('imagePreview');
                preview.src = profileImageBase64;
                preview.style.display = 'block';
                
                showFlashMessage('📸 Profile picture uploaded successfully! Looking great!', 'success');
            };
            
            reader.onerror = function() {
                showFlashMessage('❌ Error reading the image file. Please try again.', 'error');
            };
            
            reader.readAsDataURL(file);
        }

        // Enhanced campus-specific information
        function updateCampusInfo() {
            const campus = document.getElementById('campus').value;
            const campusInfo = document.getElementById('campusSpecificInfo');
            const benefitsList = document.getElementById('campusBenefitsList');
            
            if (!campus) {
                campusInfo.style.display = 'none';
                return;
            }

            const campusBenefits = {
                'CHRIST_BLR': [
                    '🌟 Access to Christ University marketplace',
                    '🏢 Bangalore PG and housing listings',
                    '🍕 Campus cafeteria meal plans',
                    '🚌 City transport optimization'
                ],
                'DU_DELHI': [
                    '🎯 Delhi University student network',
                    '🏛️ Central Delhi accommodation',
                    '🚇 Metro-based transport planning',
                    '📚 DU-specific study materials'
                ],
                'VIT_VEL': [
                    '⚡ VIT campus marketplace',
                    '🏫 Vellore hostel management',
                    '🔧 Engineering-specific budgeting',
                    '🌮 Campus food court optimization'
                ],
                'BITS_PIL': [
                    '💎 BITS Pilani premium network',
                    '🏜️ Rajasthan accommodation',
                    '📊 Engineering expense tracking',
                    '🎓 Campus placement preparation'
                ]
            };

            const benefits = campusBenefits[campus] || ['🔄 General campus features', '📊 Standard analytics', '💰 Basic budgeting', '🎯 Goal tracking'];
            
            benefitsList.innerHTML = benefits.map(benefit => 
                `<div class="campus-benefit">${benefit}</div>`
            ).join('');
            
            campusInfo.style.display = 'block';
        }

        // ✅ CLEAN REGISTRATION FUNCTION - NO PREDEFINED SAMPLE DATA
        function handleRegister(event) {
            event.preventDefault();
            
            // Collect all form data
            const formData = {
                // Basic Information
                fullName: document.getElementById('fullName').value.trim(),
                username: document.getElementById('username').value.toLowerCase().trim(),
                email: document.getElementById('email').value.toLowerCase().trim(),
                phone: document.getElementById('phone').value.trim(),
                password: document.getElementById('password').value,
                
                // Academic Information  
                campus: document.getElementById('campus').value,
                course: document.getElementById('course').value,
                year: document.getElementById('year').value,
                semester: document.getElementById('semester').value,
                regNumber: document.getElementById('rollNumber').value.trim(), // ✅ ACTUAL USER INPUT
                
                // Location & Personal
                city: document.getElementById('city').value.trim(),
                state: document.getElementById('state').value,
                accommodation: document.getElementById('accommodation').value,
                familyIncome: document.getElementById('familyIncome').value,
                
                // Financial Planning
                monthlyBudget: parseFloat(document.getElementById('budget').value),
                savingsGoal: parseFloat(document.getElementById('savingsGoal').value) || 0,
                careerGoals: document.getElementById('careerGoals').value.trim(),
                
                // System Data
                profileImage: profileImageBase64,
                id: 'user_' + Date.now(),
                createdAt: new Date().toISOString(),
                lastLogin: new Date().toISOString()
            };

            // Enhanced validation
            if (document.getElementById('password').value !== document.getElementById('confirmPassword').value) {
                showFlashMessage('❌ Passwords do not match! Please check and try again.', 'error');
                return;
            }

            if (formData.password.length < 8) {
                showFlashMessage('❌ Password must be at least 8 characters long!', 'error');
                return;
            }

            if (!formData.fullName || !formData.username || !formData.email) {
                showFlashMessage('❌ Please fill in all required fields!', 'error');
                return;
            }

            // ✅ CHECK FOR EXISTING USERS - NO DUPLICATE ACCOUNTS
            let users = JSON.parse(localStorage.getItem('backpack_users') || '[]');
            if (users.find(u => u.username === formData.username || u.email === formData.email)) {
                showFlashMessage('❌ Account already exists! Please use different credentials or sign in.', 'error');
                return;
            }
            
            // ✅ SAVE NEW USER WITH REAL DATA
            users.push(formData);
            localStorage.setItem('backpack_users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(formData));
            
            // ✅ INITIALIZE CLEAN DATA STRUCTURES - NO SAMPLE DATA
            initializeCleanUserData(formData.id);
            
            // Success message with personalization
            const campusNames = {
                'CHRIST_BLR': 'Christ University',
                'DU_DELHI': 'Delhi University',
                'VIT_VEL': 'VIT Vellore',
                'BITS_PIL': 'BITS Pilani',
                'IIT_BOM': 'IIT Bombay',
                'IIT_DEL': 'IIT Delhi'
            };
            
            const campusName = campusNames[formData.campus] || 'your university';
            showFlashMessage(`🎉 Welcome to Backpack Optimizer, ${formData.fullName}! Your ${campusName} account with roll number ${formData.regNumber} is ready!`, 'success');
            
            setTimeout(() => {
                window.location.href = 'dashboard.html';
            }, 2000);
        }

        // ✅ INITIALIZE CLEAN DATA - NO PREDEFINED SAMPLE CONTENT
        function initializeCleanUserData(userId) {
            // Initialize EMPTY arrays for user data - NO sample content
            if (!localStorage.getItem('backpack_expenses')) {
                localStorage.setItem('backpack_expenses', JSON.stringify([]));
            }
            if (!localStorage.getItem('backpack_wishlist')) {
                localStorage.setItem('backpack_wishlist', JSON.stringify([]));
            }
            if (!localStorage.getItem('backpack_marketplace')) {
                localStorage.setItem('backpack_marketplace', JSON.stringify([]));
            }
            if (!localStorage.getItem('backpack_housing')) {
                localStorage.setItem('backpack_housing', JSON.stringify([]));
            }
            
            console.log('✅ Clean data structures initialized for user:', userId);
            console.log('✅ No sample data added - fresh start for user');
        }

        function showFlashMessage(message, type = 'success') {
            // Remove existing flash message
            const existingFlash = document.querySelector('.flash-message');
            if (existingFlash) {
                existingFlash.remove();
            }

            const flash = document.createElement('div');
            flash.className = 'flash-message';
            if (type === 'error') flash.classList.add('flash-error');
            
            flash.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span>${message}</span>
                    <span onclick="this.parentElement.parentElement.remove()" 
                          style="cursor:pointer;font-size:18px;font-weight:bold;margin-left:auto;">&times;</span>
                </div>
            `;
            
            document.body.appendChild(flash);
            
            setTimeout(() => {
                if (flash.parentNode) {
                    flash.style.animation = 'slideOut 0.3s ease forwards';
                    setTimeout(() => flash.remove(), 300);
                }
            }, type === 'error' ? 8000 : 6000);
        }

        // Enhanced UX features
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-focus first field
            document.getElementById('fullName').focus();
            
            // Real-time password matching
            document.getElementById('confirmPassword').addEventListener('input', function() {
                const password = document.getElementById('password').value;
                const confirm = this.value;
                
                if (confirm && password !== confirm) {
                    this.style.borderColor = 'var(--danger-red)';
                } else {
                    this.style.borderColor = 'var(--system-gray4)';
                }
            });

            // Username validation - only allow letters, numbers, underscore
            document.getElementById('username').addEventListener('input', function() {
                this.value = this.value.toLowerCase().replace(/[^a-z0-9_]/g, '');
            });

            // Auto-fill city based on campus selection
            document.getElementById('campus').addEventListener('change', function() {
                const campusCities = {
                    'CHRIST_BLR': 'Bangalore',
                    'DU_DELHI': 'New Delhi',
                    'VIT_VEL': 'Vellore',
                    'BITS_PIL': 'Pilani',
                    'IIT_BOM': 'Mumbai',
                    'IIT_DEL': 'New Delhi'
                };
                
                const cityField = document.getElementById('city');
                if (campusCities[this.value] && !cityField.value) {
                    cityField.value = campusCities[this.value];
                }
            });

            console.log('🎒 Registration System Ready');
            console.log('✅ Fixed: Users can enter their actual roll number');
            console.log('✅ Fixed: No predefined sample data');
            console.log('✅ Fixed: Clean initialization for all modules');
        });

        // Add CSS for slideOut animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        // 📱 MOBILE SIDEBAR TOGGLE FUNCTIONALITY
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const menuToggle = document.getElementById('mobileMenuToggle');
    const overlay = document.getElementById('mobileOverlay');
    
    if (!sidebar || !menuToggle || !overlay) return;
    
    const isOpen = sidebar.classList.contains('mobile-open');
    
    if (isOpen) {
        closeSidebar();
    } else {
        openSidebar();
    }
}

function openSidebar() {
    const sidebar = document.getElementById('sidebar');
    const menuToggle = document.getElementById('mobileMenuToggle');
    const overlay = document.getElementById('mobileOverlay');
    
    if (!sidebar || !menuToggle || !overlay) return;
    
    sidebar.classList.add('mobile-open');
    menuToggle.classList.add('active');
    overlay.classList.add('show');
    
    // Prevent body scroll when sidebar is open
    document.body.style.overflow = 'hidden';
}

function closeSidebar() {
    const sidebar = document.getElementById('sidebar');
    const menuToggle = document.getElementById('mobileMenuToggle');
    const overlay = document.getElementById('mobileOverlay');
    
    if (!sidebar || !menuToggle || !overlay) return;
    
    sidebar.classList.remove('mobile-open');
    menuToggle.classList.remove('active');
    overlay.classList.remove('show');
    
    // Restore body scroll
    document.body.style.overflow = 'auto';
}

// Close sidebar when clicking navigation links (mobile)
document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
        link.addEventListener('click', function() {
            if (window.innerWidth <= 768) {
                closeSidebar();
            }
        });
    });
    
    // Close sidebar on window resize to desktop
    window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
            closeSidebar();
        }
    });
    
    // Handle keyboard navigation (ESC to close)
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && window.innerWidth <= 768) {
            closeSidebar();
        }
    });
});

    </script>
</body>
</html>
