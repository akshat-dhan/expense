<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- ğŸ“± PWA MANIFEST -->
    <link rel="manifest" href="/manifest.json">

    <!-- ğŸ iOS SPECIFIC -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Backpack Optimizer">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <link rel="apple-touch-startup-image" href="/icons/icon-512.png">

    <!-- ğŸ¤– ANDROID/CHROME -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#007AFF">

    <!-- ğŸªŸ WINDOWS -->
    <meta name="msapplication-TileColor" content="#007AFF">
    <meta name="msapplication-TileImage" content="/icons/icon-192.png">

    <!-- ğŸ” SEO & SOCIAL -->
    <meta name="application-name" content="Backpack Optimizer">
    <meta name="description" content="AI-powered financial management for Indian students">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backpack Optimizer - Elite Profile Dashboard</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="profile.css">
</head>
<body>
    <!-- ğŸ“± FIXED MOBILE MENU TOGGLE BUTTON -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </button>

    <!-- ğŸ“± MOBILE OVERLAY -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Enhanced Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">ğŸ’ Backpack Optimizer</div>
            <div class="tagline">Elite Profile Dashboard</div>
        </div>
        
        <div class="user-profile">
            <div class="user-avatar" id="userAvatar">A</div>
            <div id="userName" style="font-size: 20px; font-weight: 800;">Loading...</div>
            <div id="userCampus" style="font-size: 14px; opacity: 0.9;">Loading...</div>
            <div style="font-size: 12px; margin-top: 8px; opacity: 0.8;" id="userRegNumber">Loading...</div>
            <div style="font-size: 13px; margin-top: 12px; background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 12px;">ğŸ‘¤ Profile Master</div>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="dashboard.html" class="nav-link">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="expenses.html" class="nav-link">
                    <span class="nav-icon">ğŸ’¸</span>
                    <span>My Expenses</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="add-expense.html" class="nav-link">
                    <span class="nav-icon">â•</span>
                    <span>Add Expense</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="wishboard.html" class="nav-link">
                    <span class="nav-icon">â­</span>
                    <span>Wishboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="marketplace.html" class="nav-link">
                    <span class="nav-icon">ğŸ›’</span>
                    <span>Marketplace</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="housing.html" class="nav-link">
                    <span class="nav-icon">ğŸ </span>
                    <span>Housing</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="analytics.html" class="nav-link">
                    <span class="nav-icon">ğŸ“ˆ</span>
                    <span>Analytics</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="profile.html" class="nav-link active">
                    <span class="nav-icon">ğŸ‘¤</span>
                    <span>Profile</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" onclick="logout()">
                    <span class="nav-icon">ğŸšª</span>
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- Enhanced Main Content -->
    <div class="main-content">
        <div class="page-header">
            <h1 class="page-title">ğŸ‘¤ Elite Profile Dashboard</h1>
            <p class="page-subtitle">Your complete financial journey and achievements showcase</p>
            <div class="premium-badge">ğŸ† World's Most Advanced Student Profile</div>
        </div>

        <!-- Enhanced Profile Header with Image Support -->
        <div class="profile-header">
            <div class="profile-main-info">
                <div class="profile-image-container">
                    <div class="profile-avatar-large" id="profileAvatarLarge">
                        A
                    </div>
                    
                    <!-- Enhanced Camera/Upload Button -->
                    <div class="image-upload-btn" onclick="showImageOptions()" title="Change Profile Picture">
                        ğŸ“¸
                    </div>
                </div>
                
                <div class="profile-text-info">
                    <h2 id="profileDisplayName">Loading...</h2>
                    <p id="profileDisplayCampus">Loading...</p>
                    <p style="font-size: 1.1rem; opacity: 0.85;" id="profileDisplayRegNumber">Loading...</p>
                    <p style="font-size: 1rem; opacity: 0.8;" id="profileDisplayEmail">Loading...</p>
                    <div class="personality-display" id="profilePersonality">ğŸŒ± Smart Budgeter</div>
                </div>
            </div>
            <button class="edit-profile-btn" onclick="showEditForm()">
                âœï¸ Edit Profile
            </button>
        </div>

        <!-- Enhanced Statistics Overview -->
        <div class="stats-overview">
            <div class="stat-card" style="background: linear-gradient(135deg, #FF6B6B, #FF8E53);">
                <span class="stat-icon">ğŸ“Š</span>
                <div class="stat-value" id="profileTotalExpenses">0</div>
                <div class="stat-label">Total Expenses</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4ECDC4, #44A08D);">
                <span class="stat-icon">ğŸ’°</span>
                <div class="stat-value" id="profileAvgDaily">â‚¹0</div>
                <div class="stat-label">Avg Per Expense</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #A8E6CF, #7FCDCD);">
                <span class="stat-icon">ğŸ†</span>
                <div class="stat-value" id="profileTopCategory">ğŸ”„ None</div>
                <div class="stat-label">Top Category</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #FFD93D, #6BCF7F);">
                <span class="stat-icon">ğŸ’</span>
                <div class="stat-value" id="profileSavingsRate">100%</div>
                <div class="stat-label">Budget Remaining</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                <span class="stat-icon">ğŸ¯</span>
                <div class="stat-value" id="profileStreak">0</div>
                <div class="stat-label">Day Streak</div>
            </div>
        </div>

        <!-- Progress Tracking Section -->
        <div class="progress-section">
            <div class="progress-header">
                <div class="progress-icon">ğŸ“ˆ</div>
                <div>
                    <h3 style="margin: 0; font-weight: 900; color: var(--primary-blue);">Financial Growth Progress</h3>
                    <p style="margin: 0; color: var(--system-gray); font-size: 14px;">Track your journey to financial excellence</p>
                </div>
            </div>
            <div class="progress-grid">
                <div class="progress-item">
                    <div class="progress-value" id="monthlyProgress">0%</div>
                    <div class="progress-label">Monthly Budget Used</div>
                </div>
                <div class="progress-item">
                    <div class="progress-value" id="savingsGoal">â‚¹0</div>
                    <div class="progress-label">Monthly Savings</div>
                </div>
                <div class="progress-item">
                    <div class="progress-value" id="efficiencyScore">100%</div>
                    <div class="progress-label">Spending Efficiency</div>
                </div>
                <div class="progress-item">
                    <div class="progress-value" id="goalProgress">0/3</div>
                    <div class="progress-label">Goals Completed</div>
                </div>
            </div>
        </div>

        <!-- Enhanced Achievement System -->
        <div class="card">
            <h3 style="margin-bottom: 25px; color: var(--text-primary); font-weight: 900; font-size: 24px;">ğŸ† Achievement Showcase</h3>
            <div class="achievement-grid" id="achievementBadges">
                <div class="achievement-badge" style="background: linear-gradient(135deg, #34C759, #20B2AA);">
                    <div class="badge-date">Today</div>
                    <div class="badge-icon">ğŸŒ±</div>
                    <div class="badge-title">Financial Journey Begun</div>
                    <div class="badge-description">Started your smart budgeting adventure with Backpack Optimizer</div>
                </div>
                <div class="achievement-badge" style="background: linear-gradient(135deg, #007AFF, #5856D6);">
                    <div class="badge-date">Locked</div>
                    <div class="badge-icon">ğŸ“Š</div>
                    <div class="badge-title">Consistent Tracker</div>
                    <div class="badge-description">Track expenses for 7 consecutive days</div>
                </div>
                <div class="achievement-badge" style="background: linear-gradient(135deg, #FF9500, #FFD700);">
                    <div class="badge-date">Locked</div>
                    <div class="badge-icon">ğŸ’</div>
                    <div class="badge-title">Budget Master</div>
                    <div class="badge-description">Stay within monthly budget for 30 days</div>
                </div>
                <div class="achievement-badge" style="background: linear-gradient(135deg, #FF3B30, #FF6B6B);">
                    <div class="badge-date">Locked</div>
                    <div class="badge-icon">ğŸš€</div>
                    <div class="badge-title">Savings Champion</div>
                    <div class="badge-description">Save 20% of monthly budget</div>
                </div>
                <div class="achievement-badge" style="background: linear-gradient(135deg, #AF52DE, #FF2D92);">
                    <div class="badge-date">Locked</div>
                    <div class="badge-icon">ğŸ¯</div>
                    <div class="badge-title">Goal Achiever</div>
                    <div class="badge-description">Complete first wishboard goal</div>
                </div>
                <div class="achievement-badge" style="background: linear-gradient(135deg, #30D158, #64D2FF);">
                    <div class="badge-date">Locked</div>
                    <div class="badge-icon">ğŸ‘‘</div>
                    <div class="badge-title">Elite Student</div>
                    <div class="badge-description">Unlock all achievements and become a financial master</div>
                </div>
            </div>
        </div>

        <!-- Enhanced Edit Profile Form -->
        <div class="card" id="editProfileCard" style="display: none;">
            <h3 style="margin-bottom: 25px; font-size: 24px; font-weight: 900;">âœï¸ Edit Profile Information</h3>
            <form id="editProfileForm" onsubmit="updateProfile(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="editUsername">ğŸ‘¤ Full Name</label>
                        <input type="text" class="form-control" id="editUsername" placeholder="Your Full Name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="editEmail">ğŸ“§ Email Address</label>
                        <input type="email" class="form-control" id="editEmail" placeholder="your.email@domain.com" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="editBudget">ğŸ’° Monthly Budget (â‚¹)</label>
                        <input type="number" class="form-control" id="editBudget" step="100" placeholder="20000" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="editCampus">ğŸ« University Campus</label>
                        <select class="form-control" id="editCampus" required>
                            <option value="CHRIST_BLR">ğŸŒŸ Christ University Bangalore</option>
                            <option value="DU_DELHI">ğŸ¯ Delhi University</option>
                            <option value="VIT_VEL">âš¡ VIT Vellore</option>
                            <option value="BITS_PIL">ğŸ’ BITS Pilani</option>
                            <option value="IIT_BOM">ğŸš€ IIT Bombay</option>
                            <option value="NIT_TRI">ğŸ”¥ NIT Trichy</option>
                            <option value="IIIT_HYD">ğŸ’» IIIT Hyderabad</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="editPhone">ğŸ“± Phone Number</label>
                        <input type="tel" class="form-control" id="editPhone" placeholder="+91-9876543210">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="editCourse">ğŸ“š Course</label>
                        <select class="form-control" id="editCourse">
                            <option value="BCA">ğŸ’» BCA (Bachelor of Computer Applications)</option>
                            <option value="BBA">ğŸ’¼ BBA (Bachelor of Business Administration)</option>
                            <option value="B.Tech">ğŸ”§ B.Tech (Bachelor of Technology)</option>
                            <option value="MBA">ğŸ“ MBA (Master of Business Administration)</option>
                            <option value="MCA">ğŸ’» MCA (Master of Computer Applications)</option>
                            <option value="Other">ğŸ”„ Other</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <button type="submit" class="btn btn-success" style="flex: 1;">ğŸ’¾ Update Profile</button>
                    <button type="button" class="btn btn-secondary" onclick="hideEditForm()">âŒ Cancel</button>
                </div>
            </form>
        </div>

        <!-- Enhanced Account Settings -->
        <div class="card">
            <h3 style="margin-bottom: 25px; font-size: 24px; font-weight: 900;">âš™ï¸ Advanced Account Settings</h3>
            <div style="display: grid; gap: 20px;">
                <div class="settings-item">
                    <div class="settings-info">
                        <div class="settings-title">ğŸ“Š Export Complete Data</div>
                        <div class="settings-description">Download all your financial data including expenses, goals, and analytics in CSV format</div>
                    </div>
                    <button class="btn btn-secondary" onclick="exportData()">ğŸ“¥ Export Data</button>
                </div>
                
                <div class="settings-item">
                    <div class="settings-info">
                        <div class="settings-title">ğŸ”„ Backup & Sync</div>
                        <div class="settings-description">Create a backup of your profile and sync across devices</div>
                    </div>
                    <button class="btn" style="background: var(--gradient-primary);" onclick="backupData()">â˜ï¸ Backup Now</button>
                </div>
                
                <div class="settings-item">
                    <div class="settings-info">
                        <div class="settings-title">ğŸ¨ Theme Preferences</div>
                        <div class="settings-description">Customize your dashboard appearance and color scheme</div>
                    </div>
                    <button class="btn" style="background: var(--gradient-warning);" onclick="showThemeOptions()">ğŸŒˆ Customize</button>
                </div>
                
                <div class="settings-item">
                    <div class="settings-info">
                        <div class="settings-title">ğŸ”” Notification Settings</div>
                        <div class="settings-description">Manage budget alerts, goal reminders, and achievement notifications</div>
                    </div>
                    <button class="btn" style="background: var(--gradient-success);" onclick="manageNotifications()">ğŸ”” Manage</button>
                </div>
                
                <div class="settings-item" style="border-color: var(--danger-red);">
                    <div class="settings-info">
                        <div class="settings-title">ğŸ—‘ï¸ Reset All Data</div>
                        <div class="settings-description">Permanently delete all account data and start fresh (cannot be undone)</div>
                    </div>
                    <button class="btn btn-danger" onclick="confirmDataReset()">ğŸ—‘ï¸ Reset Account</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Image Upload Modal -->
    <div class="image-options-modal" id="imageModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 25px; color: var(--primary-blue); font-weight: 900;">ğŸ“¸ Update Profile Picture</h3>
            <p style="color: var(--system-gray); margin-bottom: 20px;">Choose how you'd like to add your profile photo</p>
            
            <div class="image-options">
                <button class="image-btn" onclick="chooseFromFiles()">
                    ğŸ“ Choose from Files
                </button>
                <button class="image-btn" onclick="captureFromCamera()">
                    ğŸ“· Use Camera
                </button>
            </div>
            
            <p style="font-size: 12px; color: var(--system-gray); margin: 15px 0;">Maximum file size: 5MB â€¢ Supported formats: JPG, PNG, WebP</p>
            
            <input type="file" id="fileInput" class="file-input" accept="image/*" onchange="handleImageUpload(event)">
            <input type="file" id="cameraInput" class="file-input" accept="image/*" capture="environment" onchange="handleImageUpload(event)">
            
            <button class="btn btn-secondary" onclick="hideImageOptions()" style="margin-top: 20px;">
                âŒ Cancel
            </button>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="profile.js"></script>
</body>
</html>
